# CH6 逻辑斯谛回归与最大熵模型

## 前言

<统计学习方法>的本章结构

1. 逻辑斯谛回归模型
   1. 逻辑斯谛分布
   1. 二项逻辑斯谛回归模型
   1. 模型参数估计
   1. 多项逻辑斯蒂回归**模型**
1. 最大熵模型
   1. 最大熵原理
   1. 最大熵模型定义
   1. 最大熵模型学习
   1. 极大似然估计
1. 模型学习的最优化算法
   1. 改进的迭代尺度法
   1. 拟牛顿法

## 逻辑斯谛回归模型

在<机器学习>上把这个叫做对数几率回归



## 最大熵

### 概念原理

逻辑斯谛回归模型和最大熵模型, 既可以看作是概率模型, 又可以看作是非概率模型.

#### 熵和概率

**Venn图**辅助理解和记忆

1. 熵可以大于1, 概率0-1之间
1. 熵衡量的是不确定性, 概率描述的是确定性
1. **联合熵**
1. **互信息**对应熵里面的交集, mutual information, 常用来描述差异性
   1. feature selection 
   1. Feature Correlation, 刻画的是相互之间的关系. 相关性主要刻画线性, 互信息刻画非线性
1. **条件熵**
1. **相对熵 (KL 散度)** 描述差异性, 从分布的角度描述差异性, 通过某种度量概率放慢的差异. 

各种熵的理解, 是构建后面的目标函数的基础.

#### 最大熵原理

1. 构建目标函数的技巧

等概率表示了对事实的无知, 因为没有更多的信息, 这种判断是合理的.

最大熵原理认为要选择的概率模型首先必须满足**已有的事实**, 即**约束条件**

最大熵原理认为不确定的部分都是等可能的, 通过熵的最大化来表示**等可能性**.

最大熵的原则, 承认已有的, 且对未来无偏



#### 最大熵原理几何解释



#### 信息熵



#### 最大熵模型

假设分类模型是一个条件概率分布, $P(Y|X)$, $X\in \cal {X} \sube R^n$

给定一个训练集 $T=\{(x_1, y_1), (x_2, y_2), \dots, (x_N, y_N)\}$

N是训练样本容量, $x \in \mathbf R^n$ 

联合分布P(X, Y)与边缘分布P(X)的经验分布分别为$\widetilde P(X, Y)和\widetilde P(X)$

$\widetilde P (X=x, Y=y)=\frac{\nu(X=x, Y=y)}{N}$

$\widetilde P (X=x)=\frac {\nu (X=x)}{N}$

上面两个就是不同的数据样本, 在训练数据集中的比例.

如果有n个**特征函数**, 就有n个**约束条件**

最大熵模型

假设满足所有约束条件的模型集合为

$\mathcal {C} \equiv \ \{P \in \mathcal {P}|E_P(f_i)=E_{\widetilde {P}}(f_i) {, i=1,2,\dots,n}\} $

定义在条件概率分布$P(Y|X)$上的条件熵为

$H(P)=-\sum \limits _{x, y} \widetilde {P}(x)P(y|x)\log P(y|x)$

则模型集合$\cal {C}$中条件熵$H(P)$最大的模型称为最大熵模型, 上式中对数为自然对数.



### 算法实现



#### 特征提取原理

通过对已知训练集数据的分析, 能够拿到联合分布的经验分布和边缘分布的经验分布.

特征函数用来描述$f(x, y)$描述输入x和输出y之间的某一事实.
$$
f(x,y) = \begin{cases}
1 & x与y满足某一事实\\
0 & 否则
\end{cases}
$$

这里, 满足的事实, 可以是in, 显然, 特征函数可以自己定义, 可以定义多个, 这些就是约束. 



#### 预测分类原理





#### 最大熵模型的学习

最大熵模型的学习过程就是求解最大熵模型的过程.

最大熵模型的学习可以形式化为约束最优化问题.
$$
\begin{eqnarray*}
\min \limits_{P\in \mathcal {C}}-H(P)=\sum\limits_{x,y}\widetilde P(x)P(y|x)\log P(y|x)\tag{6.14}\\
s.t. E_P(f_i)-E_{\widetilde P}(f_i)=0, i =1,2,\dots,n\tag{6.15}\\
\sum \limits_y P(y|x)=1\tag{6.16}
\end{eqnarray*}
$$

### 其他

课后习题的第一个题目提到了指数族分布, 这个概念在PRML中有单独的章节进行阐述.



## 参考
1. [李航·统计学习方法笔记·第6章 logistic regression与最大熵模型（2）·最大熵模型](https://blog.csdn.net/tina_ttl/article/details/53542004)

1. [最大熵模型与GIS ，IIS算法](https://blog.csdn.net/u014688145/article/details/55003910)

1. [关于最大熵模型的严重困惑：为什么没有解析解？](https://www.zhihu.com/question/49139674/answer/114670380)


